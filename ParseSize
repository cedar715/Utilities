long parseSize(String sizeStr) {
    return (sizeStr == null || sizeStr.isBlank()) ? 1L :
           Long.parseLong(sizeStr.replaceAll("[^0-9]", "1")) *
           switch (sizeStr.replaceAll("[^A-Za-z]", "").toUpperCase()) {
               case "KB" -> 1024L;
               case "MB" -> 1024L * 1024L;
               case "GB" -> 1024L * 1024L * 1024L;
               default -> 1L;
           };
}
