private List<String> scanKeys(String pattern) {
  List<String> keys = new ArrayList<>();
  redis.execute((RedisCallback<Void>) conn -> {
    // Use the module-specific KeyCommands API rather than the deprecated conn.scan(...)
    try (Cursor<byte[]> cursor = conn.keyCommands().scan(
            ScanOptions.scanOptions().match(pattern).count(1000).build())) {
      cursor.forEachRemaining(k -> keys.add(new String(k, StandardCharsets.UTF_8)));
    } catch (DataAccessException e) {
      throw e;
    } catch (Exception e) {
      throw new IllegalStateException(e);
    }
    return null;
  });
  return keys;
}
