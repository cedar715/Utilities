---
# tasks/reload_config.yml

- name: Stop the container using the CID file
  ansible.builtin.shell: |
    if [ -f /run/{{ container_name }}.cid ]; then
      /usr/bin/podman stop -t 10 $(cat /run/{{ container_name }}.cid) || true
      /usr/bin/podman rm $(cat /run/{{ container_name }}.cid) || true
    fi
  become: yes

- name: Restart the systemd service
  ansible.builtin.systemd:
    name: "{{ container_name }}.service"
    state: restarted
  become: yes

- name: Verify the container is running
  ansible.builtin.command: podman ps --filter "name={{ container_name }}"
  register: podman_status
  become: yes

- name: Print container status
  ansible.builtin.debug:
    msg: "{{ podman_status.stdout }}"
