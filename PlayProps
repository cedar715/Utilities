- name: Generate list of CNs
  hosts: localhost
  gather_facts: no
  vars:
    global_fqdn: "example.com"
    service_names:
      - grafana
      - prometheus
      - jaeger
  tasks:
    - name: Build generate_hosts list by appending domain
      set_fact:
        generate_hosts: "{{ service_names | map('regex_replace', '(.*)', '\\1.' + global_fqdn) | list }}"
      tags:
        - build_hosts
        - pre_task

    - name: Debug generate_hosts to verify
      debug:
        var: generate_hosts
      tags:
        - debug_hosts

- name: Include role to process CNs
  hosts: localhost
  roles:
    - role: your_role_name
      vars:
        generate_hosts: "{{ generate_hosts }}"
      tags:
        - generate_certs
        - role_execution
